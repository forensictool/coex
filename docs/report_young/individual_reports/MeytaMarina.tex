
В ходе проведения компьютерной экспертизы может потребоваться извлечение всех 
возможных контакт-листов злоумышленника, сохраненных локально различными 
программами, в особенности программами мгновенного обмена сообщениями. 


Программы мгновенного обмена сообщениями (Instant Messenger, IM) --- программы-клиенты, предназначенные   для обмена сообщениями в реальном времени через Интернет. С их помощью могут передаваться текстовые сообщения, звуковые сигналы, изображения, видео. Многие из таких программ-клиентов могут применяться для организации групповых текстовых чатов или видеоконференций.


Потребовалось проведение сравнительного анализа подобного рода программ-клиентов 
(ICQ, Pidgin, irc, Skype, Google Hangouts, Miranda IM и др.), 
в результате чего для разработки программного модуля в рамках проекта
<<Компьютерная экспертиза>> была выбрана программа ICQ. 


ICQ является централизованной службой мгновенного обмена сообщениями, использующей протокол OSCAR
и локализованно хранящей различного рода информацию о пользователе: переданные и полученные 
электронные сообщения и файлы,а также список контактов.


В результате исследования данной службы была получена информация о структуре хранения данных ICQ. Это, в свою очередь, позволило написать программный модуль, позволяющий извлекать 
контакт-лист из файлов, сохраняемых ICQ на жестком диске злоумышленника. 

\subsubsection{Общие сведения о программах мгновенного обмена сообщениями}

В ходе проведения сравнительного анализа программ-клиентов обмена мгновенными сообщениями
исследовались и сравнивались основные функции различных программ, их версии и год популярности.
Результаты данного исследования представлены в таблице~\ref{tab:messengers}.

\input{individual_reports/my_research_table}

На выбор  программы-клиента для реализации программного модуля повлияло не только исследование программ мгновенного обмена сообщениями, но и уровень развития навыков разработчика, а также были исключены программы Pigin и Skype, поскольку данные модули были разработаны ранее. 


Далее потребовалось ознакомиться с самим приложением ICQ версии 8.2, найти директорию, в которой хранится необходимая информация, изучить форматы и содержимое найденных файлов. 


Для идентификации пользователей служба ICQ использует UIN (Universal Identification Number) --- уникальный для каждой учётной записи номер, состоящий из 5-9 арабских цифр. Этот номер присваивается учётной записи при первичной регистрации пользователя в системе, после чего, в паре с паролем, может использоваться для аутентификации в системе. Контакты злоумышленника будут храниться в виде пар 
значений --- <<ника>> (nick) пользователя и его идентификационного номера (email) --- разделе C:\textbackslash Users\textbackslash UserName\textbackslash AppData\textbackslash Roaming\textbackslash ICQ - Profile. 


Данная информация сохраняется программой ICQ в XML - документе, пример которого представлен на рисунке~\ref{xml_view:xml_view}). Каждый xml-тэг соответствует одному элементу контактного листа и содержит значения атрибутов <<nick>> и <<email>>, которые и будут считываться программой и сохраняться в выходной файл.

\begin{figure}[h!]
\center{\includegraphics[width=0.6\linewidth]{xml_view}}
\caption{Список контактов пользователя в формате XML}
\label{xml_view:xml_view}
\end{figure}


\subsubsection{Реализация программного модуля}

Реализация программного модуля включала в себя следующие шаги:

\begin{enumerate}
\item Изучение проекта coex;
\item Изучение особенностей работы с библиотеками QT;
\item Изучение особенностей работы с XML-форматом (языка разметки);
\item Изучение системы компьютерной верстки  Latex для написания документации;
\item Изучение системы распределенного контроля версий Git и ее основных возможностей; 
\item Установка ICQ 8.2 на виртуальную машину с операционной системой Windows 7;
\item Создание информационной базы для исследования (нескольких аккаунтов, обмен соощениями и файлами);
\item Разработка программного модуля.
\end{enumerate}


\subsubsection{Алгоритм работы модуля}
Алгоритм работы модуля выглядит следующим образом: на вход программе подается XML-документ, в котором приложение ICQ хранит контактный лист пользователя. Выполняется проверка, является ли данный файл доступным для чтения. Если он таковым является, то далее создается потоковая переменная, в которую считывается информация из файла, а затем программа находит значения нужных нам атрибутов <<email>> и <<nick>>, записывая найденные значения в выходной файл, который также будет иметь формат XML-документа. Операция будет выполняться до тех пор, пока не будет достигнут конец файла, после чего файл благополучно закрывается и завершается выполнение программы.


Алгоритм синтаксического анализа входного XML--файла, содержащего контакт-лист, представлен на блок--схеме ниже (рис.~\ref{block_diagram:block_diagram}).

\begin{figure}[h!]
\center{\includegraphics[width=0.6\linewidth]{block_diagram}}
\caption{Блок-схема синтаксического анализа входного файла}
\label{block_diagram:block_diagram}
\end{figure}

Исходный код функции синтаксического анализа контактного листа приложения ICQ можно увидеть на рисунке~\ref{my_code:my_code}.

\begin{figure}[h!]
\center{\includegraphics[width=0.9\linewidth]{my_code}}
\caption{Исходный код функции синтаксического анализа контактного листа приложения ICQ}
\label{my_code:my_code}
\end{figure}

Пример результата работы модуля в виде файла в формате XML представлен на рисунке~\ref{output_xml:output_xml}.

\begin{figure}[ht]
\center{\includegraphics[width=0.6\linewidth]{output_xml}}
\caption{Пример результата работы модуля в виде файла в формате XML}
\label{output_xml:output_xml}
\end{figure}

\subsubsection{Здачи на следующий семестр}

В дальнейшем планируется дополнить модуль функцией рекурсивного обхода файловой системы для нахождения необходимых файлов, а также функциями для синтаксического анализа файлов с сообщениями злоумышленника.

\clearpage
