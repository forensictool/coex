\newpage

\chapter*{Введение}

Одной из задач на данный семестр стала задача поиска и переработки журнальных файлов Windows. Сложность данной задачи состоит в том, что все системные события хаписываются в журналы с особой структурой. Существует множество софта, позволяющего просматривать записи из данных журналов, но ни один из рассмотренных проектов не предоставлял открытый исходный код своего приложения. Но обо всем по порядку \\
Для решения данной задачи необходимо было разобратся с такими проблеамами как: \\

\begin{enumerate}
\item определить места хранения журнальных файлов операционной системы
\item изучить какие события записываются в журналы и отбросить ненужные журналы
\item разобраться со структурой журнальных файлов
\item выделить важную информацию их каждой записи журнала
\item автоматизировать процесс поиска журнальных файлов
\item реализовать конвертр журнальных файлов в формат XML
\end{enumerate}

Рассмотрим подробнее каждый этап. \\

\chapter*{Журнльные файлы операционной системы }

Во всех операционных системах Windows начиная с XP есть папка config, в данной папке помимо всего прочего находятся бинарные файлы без расширений из которых формируется реестр системы, а так же файлы с расширением .log и .evt. Как раз эти файлы и являются журналами в которые система записывает некоторые произошедшие события. Какие именно события пишутся зависит от настройки самой системы. \\

В файлы с расширением .log пишется системная информация, размер этих файлов всегда равен 1КБ. А вот файлы с расширением .evt сожержат информацию о подключении/отключении устройств, запуске/остановке программ, ошибок при работе программ, существует так же журнал загрузки операционной системы, журнал обновления системы. Так же опционально можно включить такие журналы как например журналы безопасности и обнаруденных угроз. \\

\charter*{структур .evt файлов}

Файл представляет из себя строки данныйх переменной длинны. Из сторонних источников стало извиестно что некоторые поля данных имеют определенное значение. А именно: \\
Первые 4 байта содержат длинну события в файтах, после длинны идет 4 байтный системный код сообщения. Затем 4байтовы номер записи, после него дата создания записи, время созания, идентификатор события, тип события и так далее. \\

Ниже приведен список полей записи, преднозначенной для счтиывания одного события из журнального файла. \\

	quint32 Length; \\
	quint32 Reserved; \\
	quint32 RecordNumber; \\
	quint32 TimeGenerated; \\
	quint32 TimeWritten; \\
	quint32 EventID; \\
	quint16 EventType; \\
	quint16 NumStrings; \\
	quint16 EventCategory; \\
	quint16 ReservedFlags; \\
	quint32 ClosingRecordNumber; \\
	quint32 StringOffset; \\
	quint32 UserSidLength; \\
	quint32 UserSidOffset; \\
	quint32 DataLength; \\
	quint32 DataOffset; \\

Из сторонних источников стало известно о пяти типах событий (поле EventType): \\

значение - тип события \\

\begin{enumerate}
\item 0x0001 - Error event
\item 0x0010 - Failure Audit event
\item 0x0008 - Success Audit event
\item 0x0004 - Information event
\item 0x0002 - Warning event
\end{enumerate}

У поля EventID удалось определить четыре значения: \\

\begin{enumerate}
\item 0x00 - Success
\item 0x01 - Informational
\item 0x02 - Warning
\item 0x03 - Error
\end{enumerate}

Среди множества полей записи события были выделены поля содержащие информацию о типе события, времени возникновения события и создания записи, пользователя от имени которого была сделана запись, а так же поле Data - поле с бинарными данными в которых записана подробная информация о событии. \\

\charter*{Автоматизация процесса поиска .evt файлов}

Так как комплекс работает с оброзом жесткого диска, то программе достаточно указать папку в которой находятся искомы файлы. Для поиска же можно взять список всех файлов папки и отфилтровать их по расширению .evt. Данную операцию можно сделать при помощи инструметов QDirItherator и QFileInfo из набора библиотек QT. \\

Первый инструмент необходим для получения списка файлов в папке config, а второй позволяет просматривать информацию о файлах. При просмотре иноформации будут отобраны пути до файлов с расширением .evt. После чего список путей будет передан передан процедуре обработки файлов. Которая конвертирует каждый .evt файл в XML и сохранит в диррикторию с результатами работы. Для чтения файла используется инструмент QDataStream, а для записи в XML документ QXmlSreamWriter. \\ 


На данный момент полностью реализован комплекс для работы с журнальными файлами windows XP\\

\charter*{описание используемых инструментов}

Для работы с файловыми системами в QT существует несколько библиотек. В данном проекте активно используются две: \\

\begin{enumerate}
\item QDirIterator
\item QDir
\end{enumerate}

QDirIterator — библотека, предназначенная для работы с файловой системой начиная с определенной директории как точки входа. Создав объект данного типа с указанием директории мы получим все пути которые существуют в файловой системе и начинаются с указанной директории. Данный объект поддерживает фильтрацию которая помогает выделять только необходимую информацию, исключая то, что нас не интересует, например можно вывести список только файлов находящихся в данной директории или поддиректориях, или исключить вывод символьных ссылок. Объекты данного типа используются для поиска файлов или папок на образе исследуемого диска. \\

QDir — библиотека позволяющая работать с конкретной директорией. Создав объект данного типа с указанием директории мы получим доступ к этой директории в программе и сможем работать в ней (просматривать содержимое; удалять, создавать или копировать файлы; создавать поддиректории). Данный объект так же поддерживать разные наборы фильтров выходных данных которые могут отсеивать ненужную информацию. \\

Так же данные библиотеки позволяют создавать объект QFile, который позволяет работать с файлом, путь к которому передается как параметр при создании, данный объект позволяет получить базовую информацию о файле, такую как относительный или абсолютный путь до этого файла, размер файла, тип файла или его имя. Так же позволяет перемещать или копировать данный файл.\\

Работа с xml-файлами \\

XML - eXtensible Markup Language или расширяемый язык разметки. XML разрабатывался как язык с простым формальным синтаксисом, удобный для создания и обработки документов программами и одновременно удобный для чтения и создания документов человеком. Задумка языка в том, что он позволяет дополнять данные метаданными, которые разделяют документ на объекты с атрибутами. Это позволяет упростить программную обработку документов, так как структурирует информацию. \\

В QT для работы с xml-документами используется две библиотеки: \\

\begin{enumerate}
\item QxmlStreamReader
\item QxmlStreamWriter
\end{enumerate}

Данные библиотеки позволяют создавать потоки для чтения и записи XML файлов и предоставляют набор функций для разбиения файлов на элементы и создания структур данных по записям в xml-файлах. \\

Команды для записи же позволяют записывать данные в файл автоматически дополняя методанные. Для этого существует набор команд при помощи которых создается xml-файл с заголовком, команды по созданию элемента, команды по добавлению атрибутов в элемент, команды записи конца элемента и конца файла. \\

<-----
ЗАМЕТКИ
Тут думаю ещё запилить описание написанных классов, зачем нужна каждая функция и добавить выдержки из документации о QDir* QFile* и QXmlStrea*
как источники можно указать:
1) http://doc.crossplatform.ru/qt/ - документация по QT
2) http://www.whitehats.ca/main/members/Malik/malik_eventlogs/malik_eventlogs.html - инфа о структуре evt-файлов
3) Николай Николаевич Федотов - ФОРЕНЗИКА компьютерная криминалистика 2-е издание. - как инфа о экспертизе вообще
с инфой по журналам проблема. я её по кусочкам с каких то левых форумов вытягивал. так что хз что про них можно указать.
----->